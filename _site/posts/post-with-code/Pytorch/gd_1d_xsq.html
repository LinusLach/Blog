<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>D3.js Scatter Plot with Slider</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="slider"></div>
  <svg id="scatterplot"></svg>

  <script>
    // Define data
    const coord = [[-1.000e+00, -4.000e-01,  8.000e-02,  4.640e-01,  7.710e-01,  1.017e+00, 1.214e+00, 1.371e+00, 1.497e+00, 1.597e+00, 1.678e+00, 1.742e+00, 1.794e+00, 1.835e+00, 1.868e+00, 1.894e+00, 1.916e+00,  1.932e+00, 1.946e+00, 1.957e+00],
 [ 9.000e+00, 5.760e+00, 3.686e+00, 2.359e+00, 1.510e+00, 9.660e-01, 6.180e-01, 3.960e-01, 2.530e-01, 1.620e-01, 1.040e-01, 6.600e-02, 4.300e-02, 2.700e-02, 1.700e-02, 1.100e-02, 7.000e-03, 5.000e-03,
   3.000e-03, 2.000e-03]];
    const margin = { top: 50, right: 50, bottom: 50, left: 50 };
    const width = 600 - margin.left - margin.right;
    const height = 400 - margin.top - margin.bottom;

    // Set up the slider
    const slider = d3.select("#slider")
      .append("input")
      .attr("type", "range")
      .attr("min", 0)
      .attr("max", coord[0].length - 1)
      .attr("step", 1)
      .on("input", update);

    // Set up the SVG container
    const svg = d3.select("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", `translate(${margin.left}, ${margin.top})`);

    // Set up scales
    const xScale = d3.scaleLinear()
      .domain([-2, 6])
      .range([0, width]);

    const yScale = d3.scaleLinear()
      .domain([-2, 10])
      .range([height, 0]);

    const line = d3.line()
                    .x(d => xScale(d[0]))
                    .y(d => yScale(d[1]));
    const line2 = d3.line()
        .x(d => xScale(d.x))
        .y(d => yScale(d.y));

    const data = d3.range(-2, 6, 0.1)
        .map(x => ({ x, y: Math.pow(x - 2, 2) }));
    svg.append("image")
      .attr("xlink:href", "https://upload.wikimedia.org/wikipedia/commons/3/31/Villognon_mairie.JPG")
      .attr("width", "100%")
      .attr("height", "100%")
      .attr('x',-65)
      .attr('y',-60)
      .attr("preserveAspectRatio", "none");


    // Define the update function for the slider
    function update() {
      const sliderValue = +slider.property("value");

      // Filter the data based on the slider value
      const filteredData = coord[0].slice(0, sliderValue + 1).map((x, i) => [x, coord[1][i]]);

      // Bind the data to circles
      const circles = svg.selectAll("circle")
        .data(filteredData);

      const path = svg.selectAll("path")
        .data([filteredData]);

      // Remove any circles that are no longer needed
      circles.exit().remove();
      path.exit().remove();
      // Add any new circles
      circles.enter().append("circle")
        .attr("r", 5)
        .attr("cx", d => xScale(d[0]))
        .attr("cy", d => yScale(d[1]))
        .attr("fill", "red")
        .merge(circles)
        .attr("cx", d => xScale(d[0]))
        .attr("cy", d => yScale(d[1]));

       path.enter().append("path")
           .attr("fill", "none")
           .attr("stroke", "red")
           .attr("stroke-width", 2)
           .merge(path)
           .attr("d", line);
       }
    // Call the update function initially
    update();
  </script>
</body>
</html>

