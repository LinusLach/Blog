<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>D3.js Scatter Plot with Slider</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
</head>
<body>
  <div id="slider"></div>
  <svg id="scatterplot"></svg>

  <script>
    // Define data
    const coord =[[-1., -0.413, -0.29, -0.228, -0.193, -0.171, -0.158, -0.15, -0.145, -0.141,
                -0.139, -0.137, -0.136, -0.136, -0.135, -0.135, -0.135, -0.135, -0.135, -0.135],
      [ 3.105, 1.167, 1.054, 1.024, 1.014, 1.01, 1.009, 1.008 , 1.008, 1.008,
   1.008, 1.008, 1.008, 1.008, 1.008, 1.008, 1.008,  1.008,  1.008, 1.008]] ;
    const margin = { top: 50, right: 50, bottom: 50, left: 50 };
    const width = 600 - margin.left - margin.right;
    const height = 400 - margin.top - margin.bottom;

    // Set up the slider
    const slider = d3.select("#slider")
      .append("input")
      .attr("type", "range")
      .attr("min", 0)
      .attr("max", coord[0].length - 1)
      .attr("step", 1)
      .attr("value",0)
      .on("input", update);

    // Set up the SVG container
    const svg = d3.select("svg")
      .attr("width", width + margin.left + margin.right)
      .attr("height", height + margin.top + margin.bottom)
      .append("g")
      .attr("transform", `translate(${margin.left}, ${margin.top})`);

    // Set up scales
    const xScale = d3.scaleLinear()
      .domain([-2, 6])
      .range([0, width]);

    const yScale = d3.scaleLinear()
      .domain([-2, 10])
      .range([height, 0]);

    const line = d3.line()
                    .x(d => xScale(d[0]))
                    .y(d => yScale(d[1]));

    svg.append("image")
      .attr("xlink:href", "https://raw.githubusercontent.com/LinusLach/Blog/master/posts/post-with-code/Pytorch/images/output_xquartic_lr01.png")
      .attr("width", "100%")
      .attr("height", "100%")
      .attr('x',-65)
      .attr('y',-60)
      .attr("preserveAspectRatio", "none");


    // Define the update function for the slider
    function update() {
      const sliderValue = +slider.property("value");

      // Filter the data based on the slider value
      const filteredData = coord[0].slice(0, sliderValue + 1).map((x, i) => [x, coord[1][i]]);

      // Bind the data to circles
      const circles = svg.selectAll("circle")
        .data(filteredData);

      const path = svg.selectAll("path")
        .data([filteredData]);

      // Remove any circles that are no longer needed
      circles.exit().remove();
      path.exit().remove();
      // Add any new circles
      circles.enter().append("circle")
        .attr("r", 5)
        .attr("cx", d => xScale(d[0]))
        .attr("cy", d => yScale(d[1]))
        .attr("fill", "red")
        .merge(circles)
        .attr("cx", d => xScale(d[0]))
        .attr("cy", d => yScale(d[1]));

       path.enter().append("path")
           .attr("fill", "none")
           .attr("stroke", "red")
           .attr("stroke-width", 2)
           .merge(path)
           .attr("d", line);
       }
    // Call the update function initially
    update();
  </script>
</body>
</html>

